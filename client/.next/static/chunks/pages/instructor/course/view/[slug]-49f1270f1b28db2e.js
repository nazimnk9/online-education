(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[255],{92520:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/instructor/course/view/[slug]",function(){return t(33906)}])},68252:function(e,s,t){"use strict";t.d(s,{Z:function(){return h}});var n=t(85893),a=t(67294),l=t(8433),i=t(11163),o=t(98165),c=t(41664),r=t.n(c);let d=()=>{let[e,s]=(0,a.useState)("");return(0,a.useEffect)(()=>{s(window.location.pathname)},[window.location.pathname]),(0,n.jsxs)("div",{className:"nav flex-column nav-pills",children:[(0,n.jsx)(r(),{legacyBehavior:!0,href:"/instructor",children:(0,n.jsx)("a",{className:"nav-link ".concat("/instructor"===e&&"active"),children:"Dashboard"})}),(0,n.jsx)(r(),{legacyBehavior:!0,href:"/instructor/course/create",children:(0,n.jsx)("a",{className:"nav-link ".concat("/instructor/course/create"===e&&"active"),children:"Course Create"})}),(0,n.jsx)(r(),{legacyBehavior:!0,href:"/instructor/revenue",children:(0,n.jsx)("a",{className:"nav-link ".concat("/instructor/revenue"===e&&"active"),children:"Revenue"})})]})},u=e=>{let{children:s}=e,[t,c]=(0,a.useState)(!1),r=(0,i.useRouter)();(0,a.useEffect)(()=>{u()},[]);let u=async()=>{try{let{data:e}=await l.Z.get("/api/current-instructor");e.ok&&c(!0)}catch(e){console.log(e),c(!1),r.push("/")}};return(0,n.jsx)(n.Fragment,{children:t?(0,n.jsx)("div",{className:"container-fluid",children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsx)("div",{className:"col-md-2",children:(0,n.jsx)(d,{})}),(0,n.jsx)("div",{className:"col-md-10",children:s})]})}):(0,n.jsx)(o.Z,{spin:!0,className:"d-flex justify-content-center display-1 text-primary p-5"})})};var h=u},33906:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return k}});var n=t(85893),a=t(67294),l=t(11163),i=t(68252),o=t(8433),c=t(37911),r=t(39778),d=t(71577),u=t(30143),h=t(92874),p=t(80275),m=t(86548),x=t(48489),j=t(97937),v=t(63606),f=t(88484),g=t(30724),y=t.n(g),N=t(69814),w=t(4340);let Z=e=>{let{values:s,setValues:t,handleAddLesson:a,uploading:l,uploadButtonText:i,handleVideo:o,progress:c,handleVideoRemove:u}=e;return(0,n.jsx)("div",{className:"container pt-3",children:(0,n.jsxs)("form",{onSubmit:a,children:[(0,n.jsx)("input",{type:"text",className:"form-control square",onChange:e=>t({...s,title:e.target.value}),value:s.title,placeholder:"Title",autoFocus:!0,required:!0}),(0,n.jsx)("textarea",{className:"form-control mt-3",cols:"7",rows:"7",onChange:e=>t({...s,content:e.target.value}),value:s.content,placeholder:"Content"}),(0,n.jsxs)("div",{className:"d-flex justify-content-center",children:[(0,n.jsxs)("label",{className:"btn btn-dark btn-block text-left mt-3",children:[i,(0,n.jsx)("input",{onChange:o,type:"file",accept:"video/*",hidden:!0})]}),!l&&s.video.location&&(0,n.jsx)(r.Z,{title:"Remove",children:(0,n.jsx)("span",{onClick:u,className:"pt-1 pl-3",children:(0,n.jsx)(w.Z,{className:"text-danger d-flex justify-content-center pt-4 pointer"})})})]}),c>0&&(0,n.jsx)(N.Z,{className:"d-flex justify-content-center pt-2",percent:c,steps:10}),(0,n.jsx)(d.ZP,{onClick:a,className:"col mt-3",size:"large",type:"primary",loading:l,shape:"round",children:"Save"})]})})};var b=t(22920),C=t(87215);let _=()=>{let[e,s]=(0,a.useState)({}),[t,g]=(0,a.useState)(!1),[N,w]=(0,a.useState)({title:"",content:"",video:{}}),[_,k]=(0,a.useState)(!1),[S,A]=(0,a.useState)("Upload Video"),[E,L]=(0,a.useState)(0),[T,P]=(0,a.useState)(0),U=(0,l.useRouter)(),{slug:z}=U.query;(0,a.useEffect)(()=>{R()},[z]),(0,a.useEffect)(()=>{e&&V()},[e]);let R=async()=>{let{data:e}=await o.Z.get("/api/course/".concat(z));s(e)},V=async()=>{let{data:s}=await o.Z.post("/api/instructor/student-count",{courseId:e._id});console.log("student count",s),P(s.length)},q=async t=>{t.preventDefault();try{let{data:t}=await o.Z.post("/api/course/lesson/".concat(z,"/").concat(e.instructor._id),N);console.log(t),w({...N,title:"",content:"",video:{}}),L(0),A("Upload Video"),g(!1),s(t),(0,b.Am)("Lesson Added Successfully")}catch(e){console.log(e),(0,b.Am)("Lesson Add failed")}},B=async s=>{try{let t=s.target.files[0];A(t.name),k(!0);let n=new FormData;n.append("video",t);let{data:a}=await o.Z.post("/api/course/video-upload/".concat(e.instructor._id),n,{onUploadProgress:e=>{L(Math.round(100*e.loaded/e.total))}});console.log(a),w({...N,video:a}),k(!1)}catch(e){console.log(e),k(!1),(0,b.Am)("video Upload failed")}},O=async()=>{try{k(!0);let{data:s}=await o.Z.post("/api/course/video-remove/".concat(e.instructor._id),N.video);console.log(s),w({...N,video:{}}),k(!1),A("Upload another video")}catch(e){console.log(e),k(!1),(0,b.Am)("video remove failed")}},D=async(e,t)=>{try{if(!window.confirm("Once you publish your course, it will be live in the marketplace for users to enroll"))return;let{data:e}=await o.Z.put("/api/course/publish/".concat(t));s(e),(0,b.Am)("Congratulation! Your course is live")}catch(e){(0,b.Am)("Course publish failed. Try again")}},F=async(e,t)=>{try{if(!window.confirm("Once you unpublish your course, it will not be available for users to enroll"))return;let{data:e}=await o.Z.put("/api/course/unpublish/".concat(t));s(e),(0,b.Am)("Your course is unpublished")}catch(e){(0,b.Am)("Course unpublish failed. Try again")}};return(0,n.jsx)(i.Z,{children:(0,n.jsx)("div",{className:"container-fluid pt-3",children:e&&(0,n.jsxs)("div",{className:"container-fluid pt-1",children:[(0,n.jsxs)("div",{className:"media pt-2",children:[(0,n.jsx)(c.C,{size:80,src:e.image?e.image.location:"/course.png"}),(0,n.jsx)("div",{className:"media-body pl-2",children:(0,n.jsxs)("div",{className:"row",children:[(0,n.jsxs)("div",{className:"col",children:[(0,n.jsx)("h5",{className:"mt-2 text-primary",children:e.name}),(0,n.jsxs)("p",{style:{marginTop:"-10px"},children:[e.lessons&&e.lessons.length," Lessons"]}),(0,n.jsx)("p",{style:{marginTop:"-15px",fontSize:"10px"},children:e.category})]}),(0,n.jsxs)("div",{className:"d-flex pt-4",children:[(0,n.jsx)(r.Z,{title:"".concat(T," Enrolled"),children:(0,n.jsx)(p.Z,{className:"h5 pointer text-info mr-4"})}),(0,n.jsx)(r.Z,{title:"Edit",children:(0,n.jsx)(m.Z,{onClick:()=>U.push("/instructor/course/edit/".concat(z)),className:"h5 pointer text-warning mr-4"})}),e.lessons&&e.lessons.length<5?(0,n.jsx)(r.Z,{title:"Minimum 5 lessons required to publish",children:(0,n.jsx)(x.Z,{className:"h5 pointer text-danger"})}):e.published?(0,n.jsx)(r.Z,{title:"Unpublish",children:(0,n.jsx)(j.Z,{onClick:s=>F(s,e._id),className:"h5 pointer text-danger"})}):(0,n.jsx)(r.Z,{title:"Publish",children:(0,n.jsx)(v.Z,{onClick:s=>D(s,e._id),className:"h5 pointer text-success"})})]})]})})]}),(0,n.jsx)("hr",{}),(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("div",{className:"col",children:(0,n.jsx)(y(),{source:e.description})})}),(0,n.jsx)("div",{className:"row",children:(0,n.jsx)(d.ZP,{onClick:()=>g(!0),className:"col-md-6 offset-md-3 text-center",type:"primary",shape:"round",icon:(0,n.jsx)(f.Z,{}),size:"large",children:"Add Lesson"})}),(0,n.jsx)("br",{}),(0,n.jsx)(u.Z,{title:"+ Add Lesson",centered:!0,visible:t,onCancel:()=>g(!1),footer:null,children:(0,n.jsx)(Z,{values:N,setValues:w,handleAddLesson:q,uploading:_,uploadButtonText:S,handleVideo:B,progress:E,handleVideoRemove:O})}),(0,n.jsx)("div",{className:"row pb-5",children:(0,n.jsxs)("div",{className:"col lesson-list",children:[(0,n.jsxs)("h4",{children:[e&&e.lessons&&e.lessons.length," Lessons"]}),(0,n.jsx)(h.ZP,{itemLayout:"horizontal",dataSource:e&&e.lessons,renderItem:(e,s)=>(0,n.jsx)(C.default,{children:(0,n.jsx)(C.default.Meta,{avatar:(0,n.jsx)(c.C,{children:s+1}),title:e.title})})})]})})]})})})};var k=_}},function(e){e.O(0,[911,577,466,317,536,814,652,774,888,179],function(){return e(e.s=92520)}),_N_E=e.O()}]);